# 스케줄링
> 컴퓨터 시스템 자원을 어떤 작업에게 할당해 줄지 결정하는 작업

# 스케줄링 단계
![스케줄러_단계](https://github.com/user-attachments/assets/f65b23db-88fa-4583-b375-e5da4f2af634)

## 장기 스케줄러
> 어떤 프로세스를 준비 큐에 넣을 것인가 결정

**작업 스케줄러**라고도 부른다.

**장기 스케줄러는 메모리에 동시에 올라와 있는 프로세스의 수를 조절하는 역할을 한다.**

디스크에서 프로그램을 가져와 커널에 등록하면 프로세스가 되는데, 이때 어느 프로그램을 가져와 커널에 등록할지 결정한다.

장기 스케줄러는 수십초 내지 수 분 단위로 가끔 호출되기 때문에 상대적으로 속도가 느린 것이 허용된다.

현대의 시분할 시스템에서 사용되는 운영체제에서는 일반적으로 장기 스케줄러를 두지 않는 경우가 대부분이다.
과거 자원이 부족하던 시절 적은 양의 메모리를 많은 프로세스들에게 할당하면 프로세스당 메모리 보유량이 지나치게 적어져 시스템의 효율이 떨어졌기 때문에 장기 스케줄러가 이를 조절하는 역할을 했다.

## 중기 스케줄러
> 메모리에 적재된 프로세스 수 관리

**스와퍼**(Swapper)라고도 부른다. 

**중기 스케줄러는 스와핑을 통해 메모리에 적재된 프로세스 수를 조절하는 역할을 한다.**

메모리의 여유 공간을 마련하기 위해 프로세스중 일부의 메모리를 통째로 빼앗아 그 내용을 디스크의 스왑 영역에 저장해두고(swap-out),
메모리에 여유가 생기면 다시 적재한다.(swap-in)

중기 스케줄러의 등장으로 프로세스의 상태에는 중지 상태가 추가되었다.(suspended ready, suspended blocked)

현대의 시분할 시스템에서는 프로세스가 시작 상태가 되면 장기 스케줄러 없이 곧바로 메모리를 할당해 준비큐에 넣어준다.
너무 많은 프로세스에게 메모리를 할당해 시스템의 성능이 저하될 때, 프로세스의 수를 조절하기 위해 추가된 스케줄러이다.

## 단기 스케줄러
> 메모리 내의 준비 상태에 있는 작업 중 실행할 프로세스를 선택하여 CPU를 할당

**CPU 스케줄러**라고도 부른다.

**단기 스케줄러는 준비 상태의 프로세스 중에서 어떤 프로세스에게 CPU를 할당할지 결정하는 역할을 한다.**

시분할 시스템에서 타이머 인터럽트가 발생하면 단기 스케줄러가 호출된다.

단기 스케줄러는 매우 빈번하게 호출되므로 수행 속도가 충분히 빨라야 한다.

# 스케줄링 알고리즘
스케줄링 알고리즘은 선점형(Preemptive) 스케줄링과 비선점형(Non-Preemptive) 스케줄링으로 나뉜다.

## 비선점형 스케줄링
어떤 프로세스가 CPU를 점유하고 있다면 이를 뺏을 수 없는 스케줄링 방식이다.
실행 상태에 있는 작업이 완료될 때까지 다른 작업이 불가능하다.
컨텍스트 스위칭으로 인한 부하가 상대적으로 적지만, 프로세스의 배치에 따라 효율성 차이가 크게 나게 된다.

### 1. FCFS(First Come, First Served)
준비 큐에 도착한 순서대로 CPU를 할당하는 방식이다.

### 2. SJF(Shortest Job First)
준비 큐에 있는 프로세스 중에서 실행 시간이 가장 짧은 작업부터 CPU를 할당하는 방식이다.

### 3. HRRN(Highest Response Ratio Next)
대기 시간과 CPU사용 시간을 고려하여 스케줄링을 하는 방식이다. SFJ 스케줄링에서 발생할 수 있는 *아사 현상*을 해결하기 위해 만들어졌다.

> **아사 현상**이란 우선순위가 높은 프로세스가 계속 들어오면 상대적으로 우선순위가 낮은 프로세스는 계속 실행되지 못하는 것을 말한다.

## 선점형 스케줄링
어떤 프로세스가 CPU를 할당받아 실행 중이더라도 운영체제가 이를 강제로 뺏을 수 있는 스케줄링 방식이다.
실행 상태에 있는 작업을 중단시키고 새로운 작업을 실행할 수 있다.
한 프로세스가 CPU를 장시간 독점하는 것을 막을 수 있지만, 잦은 컨텍스트 스위칭으로 인해 오버헤드가 커질 수 있다.

### 1. 라운드 로빈(Round Robin)
한 프로세스가 할당받은 시간(타임 슬라이스) 동안 작업을 하다가 작업을 완료하지 못하면 준비큐의 맨 뒤로 가서 자기 차례를 기다리는 방식이다.

### 2. SRT(Shortest Remaining Time)
SJF 스케줄링의 선점형 버전.

### 3. 우선순위 스케줄링(Priority Scheduling)
각 프로세스에 우선순위를 부여해 우선순위가 높은 프로세스를 먼저 실행시키는 방식이다.

### 4. 다단계 큐 스케줄링(Multilevel Queue)
우선순위에 따라 준비 큐를 여러 개 사용하는 방식이다. 상단 큐에 있는 모든 프로세스의 작업이 끝나야 다음 우선순위 큐의 작업이 시작된다.

### 5. 다단계 피드백 큐 스케줄링(Multilevel Feedback Queue)
우선순위가 낮은 프로세스에 불리한 다단계 큐 스케줄링의 문제점을 보완한 방식이다. CPU를 사용하고 난 프로세스는 우선순위가 낮아져 원래의 큐가 아닌 우선순위가 하나 낮은 큐의 맨 뒤로 들어간다.

---
**Reference**<br>
- https://thebook.io/080367/0045/
- https://dar0m.tistory.com/247
- https://www.crocus.co.kr/1373
- https://medium.com/@ian-white/%ED%94%84%EB%A1%9C%EC%84%B8%EC%8A%A4-%EC%8A%A4%EC%BC%80%EC%A4%84%EB%A7%81-250a5f59b9ff
- https://kosaf04pyh.tistory.com/191
 
